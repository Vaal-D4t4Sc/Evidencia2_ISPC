import mysql.connector
from mysql.connector import Error

def create_connection():
    connection = None
    try:
        connection = mysql.connector.connect(
            host="localhost",
            user="root",
            password="123123",
            database="mellon"
        )
        if connection.is_connected():
            print("Conexion exitosa!!")
    except Error as e:
        print(f"The error '{e}' occurred")
    return connection

def create_artist(connection, name, genre):
    cursor = connection.cursor()
    query = "INSERT INTO artist (Name, Genre) VALUES (%s, %s)"
    cursor.execute(query, (name, genre))
    connection.commit()
    print("Artist added successfully")

def read_artists(connection):
    cursor = connection.cursor()
    cursor.execute("SELECT * FROM artist")
    rows = cursor.fetchall()
    for row in rows:
        print(row)

def update_artist(connection, artist_id, name, genre):
    cursor = connection.cursor()
    query = "UPDATE artist SET Name = %s, Genre = %s WHERE ArtistID = %s"
    cursor.execute(query, (name, genre, artist_id))
    connection.commit()
    print("Artist updated successfully")

def delete_artist(connection, artist_id):
    cursor = connection.cursor()
    query = "DELETE FROM artist WHERE ArtistID = %s"
    cursor.execute(query, (artist_id,))
    connection.commit()
    print("Artist deleted successfully")

def main_menu():
    connection = create_connection()
    while True:
        print("\n--- Menu ---")
        print("1. Add Artist")
        print("2. View Artists")
        print("3. Update Artist")
        print("4. Delete Artist")
        print("5. Exit")
        choice = input("Choose an option: ")
        
        if choice == '1':
            name = input("Enter artist name: ")
            genre = input("Enter artist genre: ")
            create_artist(connection, name, genre)
        elif choice == '2':
            read_artists(connection)
        elif choice == '3':
            artist_id = int(input("Enter artist ID to update: "))
            name = input("Enter new artist name: ")
            genre = input("Enter new artist genre: ")
            update_artist(connection, artist_id, name, genre)
        elif choice == '4':
            artist_id = int(input("Enter artist ID to delete: "))
            delete_artist(connection, artist_id)
        elif choice == '5':
            break
        else:
            print("Invalid choice, please try again.")

if _name_ == "_main_":
    main_menu()
